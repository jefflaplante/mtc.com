# Generated by iptables-save v1.6.0 on Sun Feb 17 21:14:25 2019
*filter
:INPUT ACCEPT [25523663:14045967318]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [27127173:15865517906]
-A INPUT -p tcp -m tcp --dport 22002 -m state --state NEW -m recent --rcheck --seconds 60 --hitcount 5 --name haproxy --mask 255.255.255.255 --rsource -j REJECT --reject-with icmp-port-unreachable
-A INPUT -p tcp -m tcp --dport 22002 -m state --state NEW -m recent --set --name haproxy --mask 255.255.255.255 --rsource
-A INPUT -p tcp -m tcp --dport 80 -m state --state NEW -m recent --rcheck --seconds 60 --hitcount 150 --name webabusers --mask 255.255.255.255 --rsource -j REJECT --reject-with icmp-port-unreachable
-A INPUT -p tcp -m tcp --dport 80 -m state --state NEW -m recent --set --name webabusers --mask 255.255.255.255 --rsource
-A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -m recent --rcheck --seconds 60 --hitcount 5 --name STAHP --mask 255.255.255.255 --rsource -j DROP
-A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -m recent --set --name STAHP --mask 255.255.255.255 --rsource
COMMIT
